<div class="bogle-container">
  <!-- Banner -->
  <div class="bogle-banner">
    <p class="bogle-banner-text">New Game Everyday, Come Back and Play!</p>
  </div>
  
  @if (!gameStarted()) {
    <!-- Start Game Container -->
    <div class="start-game-container">
      @if (hasPlayedToday()) {
        <div class="already-played-message">
          <h2 class="already-played-title">You've Already Played Today!</h2>
          <p class="already-played-text">
            You've completed today's Bogle game. Come back tomorrow for a new challenge!
          </p>

          <!-- Leaderboard -->
          <app-bogle-leaderboard
            [leaderboard]="leaderboard()"
            [isLoadingLeaderboard]="isLoadingLeaderboard()"
            [playerName]="playerName()"
            [gamesPlayedCount]="gamesPlayedCount()"
            [mostCorrectAnswers]="mostCorrectAnswers()"
            [mostMissedAnswers]="mostMissedAnswers()"
            [storedGameAnswers]="storedGameAnswers()"
            [storedUserCorrectRanks]="storedUserCorrectRanks()"
            [rankType]="rankType()"
            [isLightMode]="true"
            (clearStorage)="clearLocalStorage()"
          />
        </div>
      } @else {
        <app-bogle-username
          [hasPlayedToday]="hasPlayedToday()"
          (startGame)="onStartGame($event)"
        />
      }
    </div>
  } @else {
    <app-bogle-game
      [playerName]="playerName()"
      (gameEnded)="onGameEnded($event)"
    />
  }

  <!-- Score Modal -->
  @if (showScoreModal()) {
    <div class="modal-background" (click)="closeScoreModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <h2 class="modal-title">Game Over!</h2>
        <div class="score-display">
          <div class="score-number">{{ getScore() }}/10</div>
          <div class="score-percentage">{{ (getScore() / 10 * 100).toFixed(0) }}%</div>
        </div>
        <p class="score-message">
          @if (getScore() === 10) {
            Perfect score! You got all 10 players! ðŸŽ‰
          } @else if (getScore() >= 7) {
            Great job! You got {{ getScore() }} out of 10!
          } @else if (getScore() >= 4) {
            Not bad! You got {{ getScore() }} out of 10.
          } @else {
            Keep practicing! You got {{ getScore() }} out of 10.
          }
        </p>

        <!-- Leaderboard -->
        <app-bogle-leaderboard
          [leaderboard]="leaderboard()"
          [isLoadingLeaderboard]="isLoadingLeaderboard()"
          [playerName]="playerName()"
          [gamesPlayedCount]="gamesPlayedCount()"
          [mostCorrectAnswers]="mostCorrectAnswers()"
          [mostMissedAnswers]="mostMissedAnswers()"
          [storedGameAnswers]="storedGameAnswers()"
          [storedUserCorrectRanks]="storedUserCorrectRanks()"
          [rankType]="rankType()"
          [isLightMode]="false"
          (clearStorage)="clearLocalStorage()"
        />

        <button class="modal-close-button" (click)="closeScoreModal()">Close</button>
      </div>
    </div>
  }
</div>
